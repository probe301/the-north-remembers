<!DOCTYPE html>
<html lang="zh-CN">


<head>

  <link href="/static/bootstrap.css" rel="stylesheet">
  <link href="/static/flat-ui.css" rel="stylesheet">
  <script src="static/react.js"></script>
  <script src="static/react-dom.js"></script>
  <script src="static/browser.min.js"></script>
  <script src="static/jquery-1.9.1.min.js"></script>
  {% if title %}
  <title>{{title}} - microblog</title>
  {% else %}
  <title>Welcome to microblog</title>
  {% endif %}
</head>
<body>





<div class="container-fluid">



  <div class="row-fluid">
    <div class="span8">
      <div class="page-header">
        <h1>
          The North Remembers <small>History Timeline of Zhihu</small>
        </h1>
      </div>

      <div class="row-fluid">
        <div class="span12">
          <form class="form-horizonal">
            <div class="control-group">
              <label class="control-label sr-only col-sm-1" for="inputEmail">邮箱</label>
              <div class="col-sm-5">
                <input type="text" class="form-control" placeholder="shi-yidian-ban-98 作者ID / 话题ID / 回答ID" id="zhihu-input" />
              </div>
            </div>

            <div class="control-group">
              <div class="col-sm-4">
                <button type="button" class="btn" id="zhihu-input-button"> Fetch </button>
              </div>
            </div>
          </form>

        </div>
      </div>

      <div class="row">
        <p class="text-info">
          Mark config
        </p>
      </div>
    </div>
    <div class="span4">
    </div>
  </div>
</div>



<div id='container'></div>
<div id='container_test'></div>




<script type="text/babel">

  // let ZhihuInput = React.createClass({
  //   render: function() {
  //     return <input type="text" placeholder= />;
  //   }
  // })



  let ZhihuAnswer = React.createClass({
    render: function() {
      return (
        <div className={"zhihu-answer"}>
          <div className={"div-left"}>
            checker
          </div>
          <div className={"div-right"}>
            <div className={"zhihu-answer-title"}>{this.props.data.title}</div>
            <div className={"zhihu-answer-metadata"}>{this.props.data.author}</div>
            <div className={"zhihu-answer-url"}>{this.props.data.url}</div>
          </div>
        </div>
      );
    }
  });


  let ZhihuAnswerList = React.createClass({
    getInitialState: function() {
      return {
        loading: true,
        error: null,
        data: null
      };
    },
    componentDidMount: function() {
      this.props.promise.then(
        value => this.setState({loading: false, data: value}),
        error => this.setState({loading: false, error: error})
        );
    },
    render: function() {
      if (this.state.loading) {
        return <span>Loading...</span>;
      }
      else if (this.state.error !== null) {
        return <span>Error: {this.state.error.message}</span>;
      }
      else {
        // var answers = this.state.data;
        let answers = this.state.data.map(function (answer, index) {
          return <ZhihuAnswer data={answer} />
        });
        return <div>{answers}</div>
      }
    }
  });





  $('#zhihu-input-button').click(function() {
    let author_id = $('#zhihu-input').val()
    let url = "http://127.0.0.1:5000/author/" + author_id + "?limit=5";
    ReactDOM.render(
      <ZhihuAnswerList promise={$.getJSON(url)} />,
      document.getElementById('container')
    );
  })






</script>

</body>
</html>
